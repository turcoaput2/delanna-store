{% extends "base.html" %}
{% block title %}Carrito{% endblock %}
{% block content %}
<h1 class="h3 mb-3">Tu carrito</h1>
{% if productos %}
  <div class="card border-0 shadow-sm p-3">
    {% for p in productos %}
      <div class="row align-items-center py-2 border-bottom">
        <div class="col-8 col-md-5">{{ p.nombre }}</div>
        <div class="col-4 col-md-2">$ {{ '%.2f'|format(p.precio) }}</div>
        <div class="col-8 col-md-3 mt-2 mt-md-0">
          <form method="post" action="{{ url_for('update_cart', product_id=p.id) }}" class="d-flex gap-2">
            <input class="form-control form-control-sm" type="number" min="0" name="quantity" value="{{ p.quantity }}">
            <button class="btn btn-sm btn-outline-primary">OK</button>
          </form>
        </div>
        <div class="col-4 col-md-2 text-end mt-2 mt-md-0">
          <form method="post" action="{{ url_for('remove_cart_item', product_id=p.id) }}">
            <button class="btn btn-sm btn-outline-danger">Quitar</button>
          </form>
        </div>
      </div>
    {% endfor %}
    <div class="d-flex justify-content-between align-items-center mt-3">
      <strong>Total: $ {{ '%.2f'|format(total) }}</strong>
      <div class="d-flex gap-2">
        <form method="post" action="{{ url_for('clear_cart') }}"><button class="btn btn-outline-secondary">Vaciar</button></form>
        <form method="post" action="{{ url_for('checkout') }}"><button class="btn btn-success">Confirmar pedido</button></form>
      </div>
    </div>
  </div>
{% else %}
  <p class="text-muted">Tu carrito está vacío.</p>
{% endif %}
{% endblock %}
